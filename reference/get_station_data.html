<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gather air quality observations from multiple networks and data sources — get_station_data • airquality</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gather air quality observations from multiple networks and data sources — get_station_data"><meta name="description" content='This is the general use function for gathering air quality observation data in a
standardized format for all desired monitoring networks and data sources available in this package.
It either uses OpenStreetMap to look up a polygon for (a) specified location(s) or user-provided polygons to
search for monitoring stations within a buffer distance of the polygon(s) from
the specified networks/sources. The data from those stations for the desired period
are then downloaded, standardized, combined, and returned.
Currently the following monitoring networks and data sources are available:
FEM (Regulatory-grade "Federal Equivalent Method") monitors:
AirNow (US/Global, non-validated, real-time)
BCgov (B.C. (Canada), validated and non-validated, real-time)

'><meta property="og:description" content='This is the general use function for gathering air quality observation data in a
standardized format for all desired monitoring networks and data sources available in this package.
It either uses OpenStreetMap to look up a polygon for (a) specified location(s) or user-provided polygons to
search for monitoring stations within a buffer distance of the polygon(s) from
the specified networks/sources. The data from those stations for the desired period
are then downloaded, standardized, combined, and returned.
Currently the following monitoring networks and data sources are available:
FEM (Regulatory-grade "Federal Equivalent Method") monitors:
AirNow (US/Global, non-validated, real-time)
BCgov (B.C. (Canada), validated and non-validated, real-time)

'><meta property="og:image" content="https://b-nilson.github.io/airquality/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">airquality</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/B-Nilson/airquality/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Gather air quality observations from multiple networks and data sources</h1>
      <small class="dont-index">Source: <a href="https://github.com/B-Nilson/airquality/blob/main/R/data_utils.R" class="external-link"><code>R/data_utils.R</code></a></small>
      <div class="d-none name"><code>get_station_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the general use function for gathering air quality observation data in a
standardized format for all desired monitoring networks and data sources available in this package.</p>
<p>It either uses OpenStreetMap to look up a polygon for (a) specified location(s) or user-provided polygons to
search for monitoring stations within a buffer distance of the polygon(s) from
the specified networks/sources. The data from those stations for the desired period
are then downloaded, standardized, combined, and returned.</p>
<p>Currently the following monitoring networks and data sources are available:</p>
<p>FEM (Regulatory-grade "Federal Equivalent Method") monitors:</p><ol><li><p>AirNow (US/Global, non-validated, real-time)</p></li>
<li><p>BCgov (B.C. (Canada), validated and non-validated, real-time)</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_station_data</span><span class="op">(</span></span>
<span>  <span class="va">locations</span>,</span>
<span>  <span class="va">date_range</span>,</span>
<span>  buffer_dist <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  networks <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  sources <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-locations">locations<a class="anchor" aria-label="anchor" href="#arg-locations"></a></dt>
<dd><p>A character vector with at least one value that indicates a
location on Open Street Map that data is desired for (ie. "Prince George, BC, Canada", or "Canada"),
OR an sf object with polygon(s) indicating area of interest.</p></dd>


<dt id="arg-date-range">date_range<a class="anchor" aria-label="anchor" href="#arg-date-range"></a></dt>
<dd><p>(Optional).
A datetime vector (or a character vector with dates in "YYYY-MM-DD HH:MM:SS" format, or "now" for current hour) with either 1 or 2 values.
Providing a single value will return data for that hour only,
whereas two values will return data between (and including) those times.
Dates are "backward-looking", so a value of "2019-01-01 01:00" covers from "2019-01-01 00:01"- "2019-01-01 01:00".
Default is "now" (the current hour).</p></dd>


<dt id="arg-buffer-dist">buffer_dist<a class="anchor" aria-label="anchor" href="#arg-buffer-dist"></a></dt>
<dd><p>(Optional) A single numeric value indicating the distance
to buffer the station search location by (typically units of km).
Default is 10.</p></dd>


<dt id="arg-networks">networks<a class="anchor" aria-label="anchor" href="#arg-networks"></a></dt>
<dd><p>(Optional) A character vector indicating which monitoring networks to get data for.
Default is "all".</p></dd>


<dt id="arg-sources">sources<a class="anchor" aria-label="anchor" href="#arg-sources"></a></dt>
<dd><p>(Optional) A character vector indicating which data sources to get data from.
Default is "all".</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>(Optional).
A single logical (TRUE or FALSE) value indicating if
non-critical messages/warnings should be silenced.
Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two elements, the first called "stations" is an sf POINT object with all
stations from the specified monitoring networks and data sources
within a specified location + buffer.
The second is a tibble of hourly observation data over the date range for those
stations IDs / networks / sources.</p>
<p>The columns date_utc, date_local, site_id, site_named, and quality_assured will always be returned
Observation columns will be named "pollutant_averagingTime_unit", and
will be present depending on available data from station(s) and data sources.
Some sources may have additional columns included not found in others.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Get data for all stations within 10 km of Fort St. John, BC</span></span></span>
<span class="r-in"><span><span class="co">#  for the first hour of Feb 2019</span></span></span>
<span class="r-in"><span><span class="fu">get_station_data</span><span class="op">(</span>locations <span class="op">=</span> <span class="st">"Fort St. John, BC, Canada"</span>, date_range <span class="op">=</span> <span class="st">"2019-02-01 01:00:00"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Adding a search buffer of 10 km to each location (see arg `buffer_dist`)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FEM - BCgov : 4 station(s) to check for data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data from the 'BCgov' repository are collected from the British Columbia Ministry of Environment and Climate Change Strategy and are NOT to be used commercially. Recent observations are not quality assured, and are intended for research and/or situational awareness (**NOT for regulatory decision making**). See `https://www2.gov.bc.ca/gov/content/environment/air-land-water/air` for more information.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Error in standardize_data_format(dplyr::bind_rows(archived_data, realtime_data), : No data available before reformatting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FEM - AirNow : 1 station(s) to check for data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data from the 'AirNow' repository are collected from the US Environmental Protection Agency and are NOT to be used commercially. Recent observations are not quality assured, and are intended for research and/or situational awareness (**NOT for regulatory decision making**). See `https://www.airnow.gov` for more information.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-10-25 19:30:14: Getting hourly files</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-10-25 19:30:15: Getting station metadata</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Error in data_fun(stations = site_ids, date_range, quiet = quiet): No data available for desired stations during specified date range.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 5 features and 4 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -120.8561 ymin: 56.23179 xmax: -120.8094 ymax: 56.25772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   site_id       site_name               network source             geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> E243516       Fort St John NP Cultur… FEM     BCgov   (-120.8489 56.2458)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> E299830       Fort St John Key Learn… FEM     BCgov  (-120.8561 56.24472)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> E304550       Fort St John 85th Aven… FEM     BCgov  (-120.8539 56.23179)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> FSJ OGC CAMEL Fort St John Hospital   FEM     BCgov  (-120.8094 56.25772)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 000105501     Fort St John NP Cultur… FEM     AirNow  (-120.8489 56.2458)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get data for all FEM stations within 25 km of 2 BC cities from AirNow only</span></span></span>
<span class="r-in"><span><span class="co">#  for the first hour of Feb 2019</span></span></span>
<span class="r-in"><span><span class="fu">get_station_data</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vanderhoof BC, Canada"</span>, <span class="st">"Kamloops, BC, Canada"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"2019-02-01 01:00:00"</span>,</span></span>
<span class="r-in"><span>  buffer_dist <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  networks <span class="op">=</span> <span class="st">"FEM"</span>, sources <span class="op">=</span> <span class="st">"AirNow"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No polygonal boundary for Vanderhoof BC, Canada. Returning the bounding boxes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Adding a search buffer of 25 km to each location (see arg `buffer_dist`)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FEM - AirNow : 2 station(s) to check for data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data from the 'AirNow' repository are collected from the US Environmental Protection Agency and are NOT to be used commercially. Recent observations are not quality assured, and are intended for research and/or situational awareness (**NOT for regulatory decision making**). See `https://www.airnow.gov` for more information.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-10-25 19:30:20: Getting hourly files</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-10-25 19:30:21: Getting station metadata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 2 features and 4 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POINT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -120.3975 ymin: 50.6747 xmax: -120.3339 ymax: 50.6978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   site_id   site_name                 network source            geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 000100401 Kamloops Federal Building FEM     AirNow (-120.3339 50.6747)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 000100402 Kamloops Brocklehurst     FEM     AirNow (-120.3975 50.6978)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   date_utc            date_local site_id quality_assured pm25_1hr source network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>           <span style="color: #949494;">[ug/m^3]</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2019-02-01 <span style="color: #949494;">01:00:00</span> 2019-01-3… 000100… FALSE                6.8 AirNow FEM    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brayden Nilson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

